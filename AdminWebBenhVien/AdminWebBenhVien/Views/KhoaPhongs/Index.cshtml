@model IEnumerable<AdminWebBenhVien.EfModels.KhoaPhong>
@using AdminWebBenhVien.Controllers
@using AdminWebBenhVien.Models

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="wrapper">
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Danh sách khoa phòng<span style="color:orange"></span></h1>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="col-lg-12">
                <kendo-grid name="gridKhoaPhong" height="550">
                    <datasource type="DataSourceTagHelperType.Ajax" server-operation="false" page-size="20">
                        <transport>
                            <read url="@Url.Action(nameof(KhoaPhongsController.KhoaPhong_Read))" type="get" />
                        </transport>
                        <schema>
                            <model id="@nameof(KhoaPhongViewModel.Id)">
                                <fields>
                                    <field name="@nameof(KhoaPhongViewModel.Stt)" />
                                    <field name="@nameof(KhoaPhongViewModel.TieuDeKhoa)" />
                                    <field name="@nameof(KhoaPhongViewModel.TenKhoaPhong)" />
                                    <field name="@nameof(KhoaPhongViewModel.LuotXem)" />
                                </fields>
                            </model>
                        </schema>
                    </datasource>
                    <groupable enabled="true" />
                    <sortable enabled="true" />
                    <filterable enabled="true" />
                    <scrollable enabled="true" />
                    <pageable button-count="5" refresh="true" page-sizes="new int[] { 5, 10, 20 }">
                    </pageable>
                    <filterable enabled="true" />
                    <columns>
                        <column field="@nameof(KhoaPhongViewModel.Stt)" title="STT" width="80" />
                        <column field="@nameof(KhoaPhongViewModel.TieuDeKhoa)" title="Tiêu đề khoa" width="200" />
                        <column field="@nameof(KhoaPhongViewModel.TenKhoaPhong)" title="Tên khoa" width="200" />
                        <column field="@nameof(GioiThieuChiTietViewModel.LuotXem)" title="Lượt xem" width="150" />
                        <column title="Thao tác" width="150">
                            <commands>
                                <column-command text="Sửa" name="btnCapNhat" class-name="k-primary" click="btnCapNhat_Click"></column-command>
                            </commands>
                        </column>
                    </columns>
                </kendo-grid>
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        var urlCapNhat = "@Url.Action(nameof(KhoaPhongsController.Edit), new { id = Constants.PARAM_KHOA_PHONG_ID })";

        function btnCapNhat_Click(e) {

            e.preventDefault();

            var kendoGrid = $("#gridKhoaPhong").data("kendoGrid");
            var tr = $(e.currentTarget).closest("tr");
            var data = kendoGrid.dataItem(tr);

            var url = urlCapNhat.replace("@Constants.PARAM_KHOA_PHONG_ID", data.id);
            window.open(url, "_blank");
        };
    </script>
}

